<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>陣列進階操作 filter() - 三條件組合</title>
    <link rel="stylesheet" href="./css/normalize.css" />
    <link rel="stylesheet" href="./css/02-11.css" />
  </head>
  <body>
    <div id="app">
      <ul class="tit_select">
        <li></li>
        <li>
          <select id="user_money">
            <option value="0">選擇錢</option>
            <option value="300">大於300</option>
            <option value="700">大於700</option>
            <option value="10000">大於10000</option>
          </select>
        </li>
        <li>
          <select id="user_age">
            <option value="0">選擇年齡</option>
            <option value="10">10歲以上</option>
            <option value="20">20歲以上</option>
            <option value="30">30歲以上</option>
          </select>
        </li>
        <li>
          <select id="user_sex">
            <option value="no">選擇性別</option>
            <option value="boy">boy</option>
            <option value="girl">girl</option>
          </select>
        </li>
      </ul>
      <ul class="tit">
        <li>名字</li>
        <li>戶頭錢</li>
        <li>年齡</li>
        <li>性別</li>
      </ul>
      <div class="itemList">
        <!-- <ul class="tit2">
                <li>小豬</li>
                <li>12000</li>
                <li>12</li>
                <li>boy</li>
            </ul> -->
      </div>
    </div>

    <script src="./js/data.js"></script>
    <script>
      const itemList = document.querySelector(".itemList");
      const user_money = document.querySelector("#user_money");
      const user_age = document.querySelector("#user_age");
      const user_sex = document.querySelector("#user_sex");
      let html = "";
      let newData = data;

      let isMoney = 0;
      let isAge = 0;
      let isSex = "no";

      //畫面渲染
      function DOMrender(arr) {
        html = "";
        itemList.innerHTML = "";
        arr.forEach((item) => {
          html += `
            <ul class="tit2">
              <li>${item.name}</li>
              <li>${item.money}</li>
              <li>${item.age}</li>
              <li>${item.sex}</li>
            </ul>
          `;
        });
        itemList.innerHTML = html;
      }

      function SeachData(value, type) {
        switch (type) {
          case "money":
            isMoney = Number(value);
            break;
          case "age":
            isAge = Number(value);
            break;
          case "sex":
            isSex = value;
            break;
        }

        const filterData = newData
          .filter((item) => {
            return item.money > isMoney;
          })
          .filter((item) => {
            return item.age > isAge;
          })
          .filter((item) => {
            if (isSex === "no") return item;
            return item.sex === isSex;
          });
        DOMrender(filterData);
      }

      user_money.addEventListener("change", (e) => {
        SeachData(e.target.value, "money");
      });
      user_age.addEventListener("change", (e) => {
        SeachData(e.target.value, "age");
      });
      user_sex.addEventListener("change", (e) => {
        SeachData(e.target.value, "sex");
      });

      DOMrender(newData);
    </script>
  </body>
</html>
